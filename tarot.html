<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TAROT - DEDSEC</title>
  <link rel="stylesheet" href="css/style.css?v=2">
  <style>
    .tarot-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60vh;
      gap: 2rem;
    }

    .play-button {
      padding: 1.5rem 4rem;
      background: transparent;
      border: 3px solid var(--color-secondary);
      color: var(--color-secondary);
      font-family: 'Share Tech Mono', monospace;
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      z-index: 10;
    }

    .play-button:hover {
      background: var(--color-secondary);
      color: #000000;
      box-shadow: 
        0 0 20px rgba(0, 255, 132, 0.5),
        0 0 40px rgba(0, 255, 132, 0.3);
      transform: translateY(-3px);
    }

    .play-button:active {
      transform: translateY(0);
    }

    .play-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      pointer-events: none;
    }

    .card-display {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 2rem;
      width: 100%;
      max-width: 600px;
      animation: fadeIn 0.8s ease-in;
    }

    .card-display.active {
      display: flex;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card-image-container {
      position: relative;
      width: 100%;
      max-width: 400px;
      aspect-ratio: 2/3;
      border: 3px solid var(--color-border);
      background: rgba(0, 0, 0, 0.8);
      overflow: hidden;
      box-shadow: 
        0 0 30px rgba(0, 255, 132, 0.4),
        inset 0 0 30px rgba(0, 0, 0, 0.5);
    }

    .card-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .card-image-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-secondary);
      font-size: 1.2rem;
      text-align: center;
      padding: 2rem;
      font-family: 'Share Tech Mono', monospace;
    }

    .card-info {
      background: rgba(0, 0, 0, 0.7);
      border: 2px solid var(--color-border);
      padding: 2rem;
      width: 100%;
    }

    .card-name {
      font-size: 2rem;
      font-weight: 700;
      color: var(--color-secondary);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 10px rgba(0, 255, 132, 0.5);
    }

    .card-type {
      font-size: 0.9rem;
      color: var(--color-text);
      opacity: 0.7;
      margin-bottom: 1.5rem;
      font-family: 'Share Tech Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .card-meaning {
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--color-text);
      opacity: 0.9;
      font-style: italic;
    }

    .loading {
      display: none;
      color: var(--color-secondary);
      font-family: 'Share Tech Mono', monospace;
      font-size: 1.2rem;
      text-transform: uppercase;
      letter-spacing: 0.2em;
    }

    .loading.active {
      display: block;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 0.5;
      }
      50% {
        opacity: 1;
      }
    }

    @media (max-width: 768px) {
      .play-button {
        padding: 1rem 2rem;
        font-size: 1.2rem;
      }

      .card-name {
        font-size: 1.5rem;
      }

      .card-meaning {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- BG Triangles (dynamic mesh) -->
  <canvas id="bg-triangles"></canvas>
  
  <!-- Scanlines effect -->
  <div class="scanlines"></div>

  <header class="header">
    <img src="assets/Banners/Home.jpg" alt="DEDSEC" class="header-image">
    <div class="header-overlay">
      <h1 class="logo glitch" data-text="DEDSEC">DEDSEC</h1>
      <p class="subtitle">TAROT READING</p>
    </div>
  </header>

  <main class="page-content">
    <a href="index.html" class="back-button">← VOLTAR</a>

    <div class="page-header">
      <h1 class="page-title">TAROT CYBERPUNK</h1>
      <p class="page-subtitle">Descubra o que o destino reserva para você</p>
    </div>

    <div class="tarot-container">
      <button id="play-button" class="play-button">PLAY</button>
      
      <div class="loading" id="loading">SORTEANDO...</div>

      <div class="card-display" id="card-display">
        <div class="card-image-container">
          <img id="card-image" class="card-image" src="" alt="Carta de Tarot">
          <div id="card-image-placeholder" class="card-image-placeholder">
            Imagem não encontrada
          </div>
        </div>
        
        <div class="card-info">
          <h2 class="card-name" id="card-name"></h2>
          <p class="card-type" id="card-type"></p>
          <p class="card-meaning" id="card-meaning"></p>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <p>DEDSEC © 2024 | EXPECT US</p>
  </footer>

  <script>
    // Background Triangles Animation
    const triCanvas = document.getElementById('bg-triangles');
    const triCtx = triCanvas ? triCanvas.getContext('2d') : null;

    const TRI_CONFIG = {
      rows: 2,
      cols: 4,
      amplitude: 90,
      speed: 0.0002
    };

    let triPoints = [];
    let triStartTime = performance.now();

    function initTriangles() {
      if (!triCanvas || !triCtx) return;
      const w = window.innerWidth;
      const h = window.innerHeight;
      triCanvas.width = w;
      triCanvas.height = h;

      triPoints = [];
      const { rows, cols } = TRI_CONFIG;
      const margin = 0.18;
      const spanX = 1 + margin * 2;
      const spanY = 1 + margin * 2;
      for (let y = 0; y <= rows; y++) {
        for (let x = 0; x <= cols; x++) {
          const px = (-margin + (x / cols) * spanX) * w;
          const py = (-margin + (y / rows) * spanY) * h;
          const phase = Math.random() * Math.PI * 2;
          triPoints.push({ baseX: px, baseY: py, phase });
        }
      }
    }

    function getAccentColor() {
      const cs = getComputedStyle(document.documentElement);
      const c = cs.getPropertyValue('--accent-color').trim();
      return c || '#ffffff';
    }

    function drawTriangles(time) {
      if (!triCanvas || !triCtx || !triPoints.length) return;
      const w = triCanvas.width;
      const h = triCanvas.height;
      triCtx.clearRect(0, 0, w, h);

      const color = getAccentColor();
      triCtx.strokeStyle = color;
      triCtx.lineWidth = 0.7;
      triCtx.globalAlpha = 0.35;

      const { rows, cols, amplitude, speed } = TRI_CONFIG;
      const t = (time - triStartTime);

      const animated = triPoints.map(p => {
        const offset = Math.sin(t * speed + p.phase);
        const x = p.baseX + offset * amplitude;
        const y = p.baseY + Math.cos(t * speed * 1.3 + p.phase) * amplitude * 0.6;
        return { x, y };
      });

      const idx = (x, y) => y * (cols + 1) + x;

      triCtx.beginPath();
      for (let y = 0; y < TRI_CONFIG.rows; y++) {
        for (let x = 0; x < TRI_CONFIG.cols; x++) {
          const p0 = animated[idx(x, y)];
          const p1 = animated[idx(x + 1, y)];
          const p2 = animated[idx(x, y + 1)];
          const p3 = animated[idx(x + 1, y + 1)];

          triCtx.moveTo(p0.x, p0.y);
          triCtx.lineTo(p1.x, p1.y);
          triCtx.lineTo(p3.x, p3.y);

          triCtx.moveTo(p0.x, p0.y);
          triCtx.lineTo(p3.x, p3.y);
          triCtx.lineTo(p2.x, p2.y);
        }
      }
      triCtx.stroke();
      triCtx.globalAlpha = 1;
    }

    function animateTriangles(time) {
      drawTriangles(time || performance.now());
      requestAnimationFrame(animateTriangles);
    }

    if (triCanvas && triCtx) {
      initTriangles();
      window.addEventListener('resize', initTriangles);
      requestAnimationFrame(animateTriangles);
    }

    // Tarot Card Logic
    let tarotCards = [];
    const playButton = document.getElementById('play-button');
    const loading = document.getElementById('loading');
    const cardDisplay = document.getElementById('card-display');
    const cardImage = document.getElementById('card-image');
    const cardImagePlaceholder = document.getElementById('card-image-placeholder');
    const cardName = document.getElementById('card-name');
    const cardType = document.getElementById('card-type');
    const cardMeaning = document.getElementById('card-meaning');

    // Load tarot cards from JSON
    async function loadTarotCards() {
      try {
        const response = await fetch('data/tarot.json');
        tarotCards = await response.json();
      } catch (error) {
        console.error('Erro ao carregar cartas de tarot:', error);
        alert('Erro ao carregar as cartas de tarot. Verifique se o arquivo data/tarot.json existe.');
      }
    }

    // Draw a random card
    function drawCard() {
      if (tarotCards.length === 0) {
        alert('Nenhuma carta disponível. Carregue as cartas primeiro.');
        return;
      }

      // Hide card display and show loading
      cardDisplay.classList.remove('active');
      playButton.disabled = true;
      loading.classList.add('active');

      // Simulate drawing delay for dramatic effect
      setTimeout(() => {
        const randomIndex = Math.floor(Math.random() * tarotCards.length);
        const selectedCard = tarotCards[randomIndex];

        // Update card display
        cardName.textContent = selectedCard.name;
        cardType.textContent = selectedCard.type;
        cardMeaning.textContent = `"${selectedCard.meaning}"`;

        // Try to load image
        const img = new Image();
        img.onload = function() {
          cardImage.src = selectedCard.image;
          cardImage.style.display = 'block';
          cardImagePlaceholder.style.display = 'none';
        };
        img.onerror = function() {
          cardImage.style.display = 'none';
          cardImagePlaceholder.style.display = 'flex';
          cardImagePlaceholder.textContent = selectedCard.name;
        };
        img.src = selectedCard.image;

        // Show card display
        loading.classList.remove('active');
        cardDisplay.classList.add('active');
        playButton.disabled = false;
      }, 1500);
    }

    // Event listeners
    playButton.addEventListener('click', drawCard);

    // Initialize
    loadTarotCards();
  </script>
</body>
</html>

